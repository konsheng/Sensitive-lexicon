name: æ‰‹åŠ¨æˆ–è‡ªåŠ¨ä¸Šä¼  Release åŒ…

on:
  push:
    tags:
      - '*'  # è‡ªåŠ¨è§¦å‘ï¼šæ‰“ tag æ—¶è¿è¡Œ
  workflow_dispatch:     # æ‰‹åŠ¨è§¦å‘æ”¯æŒ
    inputs:
      tag_name:
        description: 'è¯·è¾“å…¥ tag åï¼ˆå¦‚ 1.0ï¼‰'
        required: true
        default: '1.0'

jobs:
  release:
    runs-on: ubuntu-latest

    steps:
      - name: æ‹‰å–ä»£ç 
        uses: actions/checkout@v3

      # è®¾ç½® tag å å’Œ zip æ–‡ä»¶å
      - name: è®¾ç½® Tag å’Œæ–‡ä»¶å
        id: release_info
        run: |
          if [ "${{ github.event_name }}" = "workflow_dispatch" ]; then
            TAG_NAME="${{ github.event.inputs.tag_name }}"
          else
            TAG_NAME="${GITHUB_REF##*/}"
          fi
          FILE_NAME="Sensitive-lexicon-${TAG_NAME}.zip"
          echo "tag_name=${TAG_NAME}" >> $GITHUB_OUTPUT
          echo "file_name=${FILE_NAME}" >> $GITHUB_OUTPUT

      - name: å‹ç¼©é¡¹ç›®
        run: |
          zip -r ${{ steps.release_info.outputs.file_name }} . -x '*.git*'

      # ğŸ¯ å…³é”®å°±åœ¨è¿™ï¼æ˜ç¡®å‘Šè¯‰ action ä½¿ç”¨å“ªä¸ª tag æ¥ä¸Šä¼  releaseï¼
      - name: ä¸Šä¼ åˆ° GitHub Release
        uses: softprops/action-gh-release@v2
        with:
          tag_name: ${{ steps.release_info.outputs.tag_name }}
          name: "Sensitive-lexicon ${{ steps.release_info.outputs.tag_name }}"
          files: ${{ steps.release_info.outputs.file_name }}
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
